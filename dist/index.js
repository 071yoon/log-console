"use strict";var We=Object.create;var I=Object.defineProperty,Xe=Object.defineProperties,Ze=Object.getOwnPropertyDescriptor,qe=Object.getOwnPropertyDescriptors,Je=Object.getOwnPropertyNames,A=Object.getOwnPropertySymbols,Ye=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var oe=(e,t,r)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,p=(e,t)=>{for(var r in t||(t={}))Z.call(t,r)&&oe(e,r,t[r]);if(A)for(var r of A(t))ne.call(t,r)&&oe(e,r,t[r]);return e},ie=(e,t)=>Xe(e,qe(t));var f=(e,t)=>{var r={};for(var o in e)Z.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&A)for(var o of A(e))t.indexOf(o)<0&&ne.call(e,o)&&(r[o]=e[o]);return r};var Ke=(e,t)=>{for(var r in t)I(e,r,{get:t[r],enumerable:!0})},se=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Je(t))!Z.call(e,n)&&n!==r&&I(e,n,{get:()=>t[n],enumerable:!(o=Ze(t,n))||o.enumerable});return e};var q=(e,t,r)=>(r=e!=null?We(Ye(e)):{},se(t||!e||!e.__esModule?I(r,"default",{value:e,enumerable:!0}):r,e)),Qe=e=>se(I({},"__esModule",{value:!0}),e);var it={};Ke(it,{LogConsole:()=>Ve,useLogScroll:()=>B,useLogStats:()=>G});module.exports=Qe(it);var Me=require("es-toolkit"),s=require("react");var m=require("react");function B(){let[e,t]=(0,m.useState)(!0),[r,o]=(0,m.useState)(!0),n=(0,m.useRef)(null),l=(0,m.useCallback)(()=>{let i=n.current;return i?{scrollTop:i.scrollTop,scrollHeight:i.scrollHeight,clientHeight:i.clientHeight}:{scrollTop:0,scrollHeight:0,clientHeight:0}},[]),v=(0,m.useCallback)(()=>{let i=n.current;i&&(i.scrollTo({behavior:"smooth",top:i.scrollHeight}),t(!0))},[]),S=(0,m.useCallback)(i=>{let x=n.current;x&&(x.scrollTop=i)},[]),b=(0,m.useCallback)(()=>{let{scrollTop:i,scrollHeight:x,clientHeight:O}=l(),R=x-i-O<1;t(R),o(i===0)},[l]);return(0,m.useEffect)(()=>{let i=n.current;if(i)return b(),i.addEventListener("scroll",b),()=>{i.removeEventListener("scroll",b)}},[b]),{scrollViewportRef:n,handleScroll:b,scrollToBottom:v,isAtBottom:e,isAtTop:r,getScrollInfo:l,setScrollTop:S}}var ae=require("react");function G(e){return(0,ae.useMemo)(()=>({total:e.length,errors:e.filter(r=>r.mainLine.toLowerCase().includes("error")).length,warnings:e.filter(r=>r.mainLine.toLowerCase().includes("warn")).length}),[e])}var le=0,J=()=>`log-${le++}`,je=/^\s*(\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}(.\d{3})?\]|\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d{3})?Z|\w{3} \d{1,2} \d{2}:\d{2}:\d{2})/,et=/^(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3})\s+\[(.*?)\]\s+([A-Z]+)\s+([a-zA-Z0-9\._-]+)\s+-\s+(.*)/;function de(e){let t=[];le=0;for(let r of e){let o=r.match(et);o?t.push({id:J(),mainLine:r,subLines:[],timestamp:o[1],thread:o[2],level:o[3],logger:o[4],message:o[5].trim()}):je.test(r)?t.push({id:J(),mainLine:r,subLines:[]}):t.length>0?t[t.length-1].subLines.push(r):t.push({id:J(),mainLine:r,subLines:[]})}return t}var he=require("lucide-react");var fe=require("@radix-ui/react-slot"),me=require("class-variance-authority");function ce(e){var t,r,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=ce(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}function ue(){for(var e,t,r=0,o="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=ce(e))&&(o&&(o+=" "),o+=t);return o}var pe=require("tailwind-merge");function c(...e){return(0,pe.twMerge)(ue(e))}var ve=require("react/jsx-runtime"),tt=(0,me.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function ge(l){var v=l,{className:e,variant:t,size:r,asChild:o=!1}=v,n=f(v,["className","variant","size","asChild"]);return(0,ve.jsx)(o?fe.Slot:"button",p({"data-slot":"button",className:c(tt({variant:t,size:r,className:e}))},n))}var Y=require("react/jsx-runtime");function be({isVisible:e,onClick:t}){return e?(0,Y.jsx)(ge,{size:"icon",className:"absolute bottom-6 right-6 rounded-full",onClick:t,children:(0,Y.jsx)(he.ArrowDown,{className:"h-4 w-4"})}):null}var _=q(require("react"));var Le=require("lucide-react");var xe=require("react/jsx-runtime");function M(r){var o=r,{className:e}=o,t=f(o,["className"]);return(0,xe.jsx)(Le.Loader2Icon,p({role:"status","aria-label":"Loading",className:c("size-4 animate-spin",e)},t))}var V=require("lucide-react"),we=require("react"),L=require("react/jsx-runtime");function ye({subLines:e}){let[t,r]=(0,we.useState)(!1);return e.length===0?null:(0,L.jsxs)("div",{className:"flex flex-col pl-4",children:[(0,L.jsxs)("button",{className:"flex items-center gap-1 text-xs text-muted-foreground hover:underline",onClick:()=>r(!t),children:[t?(0,L.jsx)(V.ChevronDown,{className:"h-3 w-3"}):(0,L.jsx)(V.ChevronRight,{className:"h-3 w-3"}),t?"Hide":`Show ${e.length} more`," lines"]}),t&&(0,L.jsx)("div",{className:"flex flex-col",children:e.map((o,n)=>(0,L.jsxs)("div",{className:"flex",children:[(0,L.jsx)("div",{className:"w-12 select-none text-right opacity-50"}),(0,L.jsx)("div",{className:"flex-1 pl-4 text-[10px]",children:o})," "]},n))})]})}var z=require("react"),Se=require("react/jsx-runtime");function Ce({line:e,level:t}){let[r,o]=(0,z.useState)(!1),n=()=>{o(!r)},l=(0,z.useMemo)(()=>{switch(t){case"ERROR":return"text-red-500";case"WARN":return"text-yellow-500";case"INFO":return"text-blue-500";case"DEBUG":return"text-gray-500";case"FATAL":return"text-red-700 font-bold";default:return""}},[t]);return(0,Se.jsx)("div",{className:`flex-1 pl-4 ${l} ${r?"":"whitespace-nowrap overflow-hidden text-ellipsis"}`,onClick:n,children:e})}var g=require("react/jsx-runtime"),Ne=_.default.memo(({logGroup:e,originalLineNumber:t,style:r})=>(0,g.jsxs)("div",{style:r,children:[(0,g.jsxs)("div",{className:"flex text-xs",children:[(0,g.jsx)("div",{className:"w-12 select-none text-right opacity-50 pr-2",children:t}),(0,g.jsx)(Ce,{line:e.mainLine,level:e.level})]}),e.subLines.length>0&&(0,g.jsx)(ye,{subLines:e.subLines})]}));Ne.displayName="LogRow";var K=(0,_.forwardRef)(({logs:e,height:t,width:r,startLineNumber:o,outerRef:n,onScroll:l,isLoadingMore:v},S)=>(0,g.jsx)("main",{className:"relative flex-1",children:(0,g.jsxs)("div",{ref:n,onScroll:l,style:{height:t>0?t:"100%",overflowY:"auto",width:r},className:"h-full",children:[v&&(0,g.jsx)("div",{className:"flex justify-center items-center p-2",children:(0,g.jsx)(M,{})}),e.map((b,i)=>(0,g.jsx)(Ne,{logGroup:b,originalLineNumber:o+i},b.id))]})}));K.displayName="LogContent";var ke=require("@radix-ui/react-slot"),Re=require("class-variance-authority");var Te=require("react/jsx-runtime"),rt=(0,Re.cva)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function D(n){var l=n,{className:e,variant:t,asChild:r=!1}=l,o=f(l,["className","variant","asChild"]);return(0,Te.jsx)(r?ke.Slot:"span",p({"data-slot":"badge",className:c(rt({variant:t}),e)},o))}var Pe=require("react/jsx-runtime");function Ee(o){var n=o,{className:e,type:t}=n,r=f(n,["className","type"]);return(0,Pe.jsx)("input",p({type:t,"data-slot":"input",className:c("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e)},r))}var Ie=q(require("@radix-ui/react-label"));var Ae=require("react/jsx-runtime");function He(r){var o=r,{className:e}=o,t=f(o,["className"]);return(0,Ae.jsx)(Ie.Root,p({"data-slot":"label",className:c("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e)},t))}var $=q(require("@radix-ui/react-switch"));var Q=require("react/jsx-runtime");function Be(r){var o=r,{className:e}=o,t=f(o,["className"]);return(0,Q.jsx)($.Root,ie(p({"data-slot":"switch",className:c("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e)},t),{children:(0,Q.jsx)($.Thumb,{"data-slot":"switch-thumb",className:c("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})}))}var d=require("react/jsx-runtime");function ot({stats:e}){return(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsxs)(D,{variant:"outline",children:["Total: ",e.total]}),(0,d.jsxs)(D,{variant:"destructive",children:["Errors: ",e.errors]}),(0,d.jsxs)(D,{variant:"secondary",children:["Warnings: ",e.warnings]})]})}function Ge({onSearchChange:e,isTailingEnabled:t,onTailingChange:r,stats:o}){return(0,d.jsxs)("header",{className:"flex h-14 items-center justify-between gap-4 border-b bg-muted/40 px-4 lg:h-[60px] lg:px-6",children:[(0,d.jsx)("div",{className:"w-full flex-1",children:(0,d.jsx)(Ee,{placeholder:"Search logs...",onChange:n=>e(n.target.value)})}),(0,d.jsxs)("div",{className:"flex items-end gap-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mr-4",children:[(0,d.jsx)(He,{htmlFor:"tail-switch",className:"text-xs",children:"Live Tailing"}),(0,d.jsx)(Be,{id:"tail-switch",checked:t,onCheckedChange:r})]}),(0,d.jsx)(ot,{stats:o})]})]})}var h=require("react/jsx-runtime"),nt=500;function Ve({logFileUrl:e,initialDisplayLines:t=nt}){let[r,o]=(0,s.useState)([]),[n,l]=(0,s.useState)([]),[v,S]=(0,s.useState)(!1),[b,i]=(0,s.useState)(!1),[x,O]=(0,s.useState)(!1),[R,ze]=(0,s.useState)(""),[_e,j]=(0,s.useState)(0),T=(0,s.useRef)(!0),E=(0,s.useRef)(!1),{scrollViewportRef:U,handleScroll:De,scrollToBottom:P,isAtBottom:F,isAtTop:ee,getScrollInfo:W,setScrollTop:te}=B(),$e=G(r);(0,s.useEffect)(()=>{if(typeof window!="undefined"){j(window.innerHeight);let a=()=>j(window.innerHeight);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)}},[]);let X=(0,s.useCallback)(async(a=!1)=>{if(!(!e||v&&!a)){a||S(!0);try{let u=await fetch(e);if(!u.ok)throw new Error(`Failed to fetch log file: ${u.statusText}`);let C=(await u.text()).split(`
`),N=de(C);if(o(N),a){let w=r.length,k=N.slice(w);k.length>0&&(l(Fe=>[...Fe,...k]),F&&requestAnimationFrame(()=>P()))}else{let w=N.length,k=Math.max(0,w-t);l(N.slice(k,w))}}catch(u){console.error("Error occurred while fetching logs:",u)}finally{a||S(!1)}}},[e,v,r,F,P,t]);(0,s.useEffect)(()=>{e&&(T.current=!0,o([]),l([]),X(!1))},[e]),(0,s.useEffect)(()=>{T.current&&n.length>0&&setTimeout(()=>{P(),T.current=!1},0)},[n,P]),(0,s.useEffect)(()=>{if(x&&e){let a=setInterval(()=>X(!0),1e3);return()=>clearInterval(a)}},[x,e,X]);let re=(0,s.useCallback)(()=>{if(E.current||n.length>=r.length)return;E.current=!0,i(!0);let{scrollHeight:a}=W();setTimeout(()=>{let u=n[0],y=r.findIndex(C=>C.id===u.id);if(y>0){let C=Math.max(0,y-t),N=r.slice(C,y);l(w=>[...N,...w]),requestAnimationFrame(()=>{if(U.current){let{scrollHeight:w}=W(),k=w-a;te(k),i(!1),E.current=!1}})}else i(!1),E.current=!1},500)},[n,r,W,te,U,t]);(0,s.useEffect)(()=>{ee&&!E.current&&!T.current&&n.length<r.length&&re()},[ee,re,n.length,r.length]);let Oe=(0,Me.throttle)(a=>ze(a),300),H=(0,s.useMemo)(()=>n.filter(a=>a.mainLine.toLowerCase().includes(R.toLowerCase())||a.subLines.some(u=>u.toLowerCase().includes(R.toLowerCase()))),[n,R]),Ue=(0,s.useMemo)(()=>{var y;if(H.length===0)return 1;let a=(y=H[0])==null?void 0:y.id,u=r.findIndex(C=>C.id===a);return u!==-1?u+1:1},[H,r]);return e?v&&T.current?(0,h.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,h.jsx)(M,{})}):(0,h.jsxs)("div",{className:"flex h-full flex-col",children:[(0,h.jsx)(Ge,{onSearchChange:Oe,isTailingEnabled:x,onTailingChange:O,stats:$e}),(0,h.jsxs)("div",{className:"relative flex-1 overflow-hidden",children:[(0,h.jsx)(K,{logs:H,height:Math.max(0,_e-100),width:"100%",startLineNumber:Ue,outerRef:U,onScroll:De,isLoadingMore:b}),(0,h.jsx)(be,{isVisible:!F,onClick:P})]})]}):(0,h.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,h.jsx)("p",{children:"Please provide a log file URL."})})}0&&(module.exports={LogConsole,useLogScroll,useLogStats});
//# sourceMappingURL=index.js.map