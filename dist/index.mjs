var Ie=Object.defineProperty,He=Object.defineProperties;var Ae=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var j=(e,t,r)=>t in e?Ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c=(e,t)=>{for(var r in t||(t={}))ee.call(t,r)&&j(e,r,t[r]);if(A)for(var r of A(t))te.call(t,r)&&j(e,r,t[r]);return e},re=(e,t)=>He(e,Ae(t));var u=(e,t)=>{var r={};for(var o in e)ee.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&A)for(var o of A(e))t.indexOf(o)<0&&te.call(e,o)&&(r[o]=e[o]);return r};import{throttle as lt}from"es-toolkit";import{useCallback as xe,useEffect as I,useMemo as we,useRef as ye,useState as x}from"react";import{useCallback as B,useEffect as Be,useRef as Ge,useState as oe}from"react";function U(){let[e,t]=oe(!0),[r,o]=oe(!0),n=Ge(null),a=B(()=>{let i=n.current;return i?{scrollTop:i.scrollTop,scrollHeight:i.scrollHeight,clientHeight:i.clientHeight}:{scrollTop:0,scrollHeight:0,clientHeight:0}},[]),p=B(()=>{let i=n.current;i&&(i.scrollTo({behavior:"smooth",top:i.scrollHeight}),t(!0))},[]),y=B(i=>{let m=n.current;m&&(m.scrollTop=i)},[]),f=B(()=>{let{scrollTop:i,scrollHeight:m,clientHeight:z}=a(),N=m-i-z<1;t(N),o(i===0)},[a]);return Be(()=>{let i=n.current;if(i)return f(),i.addEventListener("scroll",f),()=>{i.removeEventListener("scroll",f)}},[f]),{scrollViewportRef:n,handleScroll:f,scrollToBottom:p,isAtBottom:e,isAtTop:r,getScrollInfo:a,setScrollTop:y}}import{useMemo as Me}from"react";function F(e){return Me(()=>({total:e.length,errors:e.filter(r=>r.mainLine.toLowerCase().includes("error")).length,warnings:e.filter(r=>r.mainLine.toLowerCase().includes("warn")).length}),[e])}var ne=0,W=()=>`log-${ne++}`,Ve=/^\s*(\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}(.\d{3})?\]|\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d{3})?Z|\w{3} \d{1,2} \d{2}:\d{2}:\d{2})/,ze=/^(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3})\s+\[(.*?)\]\s+([A-Z]+)\s+([a-zA-Z0-9\._-]+)\s+-\s+(.*)/;function ie(e){let t=[];ne=0;for(let r of e){let o=r.match(ze);o?t.push({id:W(),mainLine:r,subLines:[],timestamp:o[1],thread:o[2],level:o[3],logger:o[4],message:o[5].trim()}):Ve.test(r)?t.push({id:W(),mainLine:r,subLines:[]}):t.length>0?t[t.length-1].subLines.push(r):t.push({id:W(),mainLine:r,subLines:[]})}return t}import{ArrowDown as Fe}from"lucide-react";import{Slot as De}from"@radix-ui/react-slot";import{cva as $e}from"class-variance-authority";function se(e){var t,r,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=se(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}function ae(){for(var e,t,r=0,o="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=se(e))&&(o&&(o+=" "),o+=t);return o}import{twMerge as _e}from"tailwind-merge";function l(...e){return _e(ae(e))}import{jsx as Ue}from"react/jsx-runtime";var Oe=$e("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function le(a){var p=a,{className:e,variant:t,size:r,asChild:o=!1}=p,n=u(p,["className","variant","size","asChild"]);return Ue(o?De:"button",c({"data-slot":"button",className:l(Oe({variant:t,size:r,className:e}))},n))}import{jsx as de}from"react/jsx-runtime";function ce({isVisible:e,onClick:t}){return e?de(le,{size:"icon",className:"absolute bottom-6 right-6 rounded-full",onClick:t,children:de(Fe,{className:"h-4 w-4"})}):null}import je,{forwardRef as et}from"react";import{Loader2Icon as We}from"lucide-react";import{jsx as Xe}from"react/jsx-runtime";function G(r){var o=r,{className:e}=o,t=u(o,["className"]);return Xe(We,c({role:"status","aria-label":"Loading",className:l("size-4 animate-spin",e)},t))}import{ChevronDown as Ze,ChevronRight as qe}from"lucide-react";import{useState as Je}from"react";import{jsx as E,jsxs as X}from"react/jsx-runtime";function ue({subLines:e}){let[t,r]=Je(!1);return e.length===0?null:X("div",{className:"flex flex-col pl-4",children:[X("button",{className:"flex items-center gap-1 text-xs text-muted-foreground hover:underline",onClick:()=>r(!t),children:[t?E(Ze,{className:"h-3 w-3"}):E(qe,{className:"h-3 w-3"}),t?"Hide":`Show ${e.length} more`," lines"]}),t&&E("div",{className:"flex flex-col",children:e.map((o,n)=>X("div",{className:"flex",children:[E("div",{className:"w-12 select-none text-right opacity-50"}),E("div",{className:"flex-1 pl-4 text-[10px]",children:o})," "]},n))})]})}import{useMemo as Ye,useState as Ke}from"react";import{jsx as Qe}from"react/jsx-runtime";function pe({line:e,level:t}){let[r,o]=Ke(!1),n=()=>{o(!r)},a=Ye(()=>{switch(t){case"ERROR":return"text-red-500";case"WARN":return"text-yellow-500";case"INFO":return"text-blue-500";case"DEBUG":return"text-gray-500";case"FATAL":return"text-red-700 font-bold";default:return""}},[t]);return Qe("div",{className:`flex-1 pl-4 ${a} ${r?"":"whitespace-nowrap overflow-hidden text-ellipsis"}`,onClick:n,children:e})}import{jsx as b,jsxs as Z}from"react/jsx-runtime";var fe=je.memo(({logGroup:e,originalLineNumber:t,style:r})=>Z("div",{style:r,children:[Z("div",{className:"flex text-xs",children:[b("div",{className:"w-12 select-none text-right opacity-50 pr-2",children:t}),b(pe,{line:e.mainLine,level:e.level})]}),e.subLines.length>0&&b(ue,{subLines:e.subLines})]}));fe.displayName="LogRow";var q=et(({logs:e,height:t,width:r,startLineNumber:o,outerRef:n,onScroll:a,isLoadingMore:p},y)=>b("main",{className:"relative flex-1",children:Z("div",{ref:n,onScroll:a,style:{height:t>0?t:"100%",overflowY:"auto",width:r},className:"h-full",children:[p&&b("div",{className:"flex justify-center items-center p-2",children:b(G,{})}),e.map((f,i)=>b(fe,{logGroup:f,originalLineNumber:o+i},f.id))]})}));q.displayName="LogContent";import{Slot as tt}from"@radix-ui/react-slot";import{cva as rt}from"class-variance-authority";import{jsx as nt}from"react/jsx-runtime";var ot=rt("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function M(n){var a=n,{className:e,variant:t,asChild:r=!1}=a,o=u(a,["className","variant","asChild"]);return nt(r?tt:"span",c({"data-slot":"badge",className:l(ot({variant:t}),e)},o))}import{jsx as it}from"react/jsx-runtime";function me(o){var n=o,{className:e,type:t}=n,r=u(n,["className","type"]);return it("input",c({type:t,"data-slot":"input",className:l("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e)},r))}import*as ge from"@radix-ui/react-label";import{jsx as st}from"react/jsx-runtime";function ve(r){var o=r,{className:e}=o,t=u(o,["className"]);return st(ge.Root,c({"data-slot":"label",className:l("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e)},t))}import*as V from"@radix-ui/react-switch";import{jsx as he}from"react/jsx-runtime";function be(r){var o=r,{className:e}=o,t=u(o,["className"]);return he(V.Root,re(c({"data-slot":"switch",className:l("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e)},t),{children:he(V.Thumb,{"data-slot":"switch-thumb",className:l("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})}))}import{jsx as P,jsxs as L}from"react/jsx-runtime";function at({stats:e}){return L("div",{className:"flex items-center gap-4",children:[L(M,{variant:"outline",children:["Total: ",e.total]}),L(M,{variant:"destructive",children:["Errors: ",e.errors]}),L(M,{variant:"secondary",children:["Warnings: ",e.warnings]})]})}function Le({onSearchChange:e,isTailingEnabled:t,onTailingChange:r,stats:o}){return L("header",{className:"flex h-14 items-center justify-between gap-4 border-b bg-muted/40 px-4 lg:h-[60px] lg:px-6",children:[P("div",{className:"w-full flex-1",children:P(me,{placeholder:"Search logs...",onChange:n=>e(n.target.value)})}),L("div",{className:"flex items-end gap-1",children:[L("div",{className:"flex items-center gap-2 mr-4",children:[P(ve,{htmlFor:"tail-switch",className:"text-xs",children:"Live Tailing"}),P(be,{id:"tail-switch",checked:t,onCheckedChange:r})]}),P(at,{stats:o})]})]})}import{jsx as w,jsxs as Ce}from"react/jsx-runtime";var dt=500;function ct({logFileUrl:e,initialDisplayLines:t=dt}){let[r,o]=x([]),[n,a]=x([]),[p,y]=x(!1),[f,i]=x(!1),[m,z]=x(!1),[N,Se]=x(""),[Ne,J]=x(0),k=ye(!0),R=ye(!1),{scrollViewportRef:_,handleScroll:ke,scrollToBottom:T,isAtBottom:D,isAtTop:Y,getScrollInfo:$,setScrollTop:K}=U(),Re=F(r);I(()=>{if(typeof window!="undefined"){J(window.innerHeight);let s=()=>J(window.innerHeight);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)}},[]);let O=xe(async(s=!1)=>{if(!(!e||p&&!s)){s||y(!0);try{let d=await fetch(e);if(!d.ok)throw new Error(`Failed to fetch log file: ${d.statusText}`);let h=(await d.text()).split(`
`),C=ie(h);if(o(C),s){let g=r.length,S=C.slice(g);S.length>0&&(a(Pe=>[...Pe,...S]),D&&requestAnimationFrame(()=>T()))}else{let g=C.length,S=Math.max(0,g-t);a(C.slice(S,g))}}catch(d){console.error("Error occurred while fetching logs:",d)}finally{s||y(!1)}}},[e,p,r,D,T,t]);I(()=>{e&&(k.current=!0,o([]),a([]),O(!1))},[e]),I(()=>{k.current&&n.length>0&&setTimeout(()=>{T(),k.current=!1},0)},[n,T]),I(()=>{if(m&&e){let s=setInterval(()=>O(!0),1e3);return()=>clearInterval(s)}},[m,e,O]);let Q=xe(()=>{if(R.current||n.length>=r.length)return;R.current=!0,i(!0);let{scrollHeight:s}=$();setTimeout(()=>{let d=n[0],v=r.findIndex(h=>h.id===d.id);if(v>0){let h=Math.max(0,v-t),C=r.slice(h,v);a(g=>[...C,...g]),requestAnimationFrame(()=>{if(_.current){let{scrollHeight:g}=$(),S=g-s;K(S),i(!1),R.current=!1}})}else i(!1),R.current=!1},500)},[n,r,$,K,_,t]);I(()=>{Y&&!R.current&&!k.current&&n.length<r.length&&Q()},[Y,Q,n.length,r.length]);let Te=lt(s=>Se(s),300),H=we(()=>n.filter(s=>s.mainLine.toLowerCase().includes(N.toLowerCase())||s.subLines.some(d=>d.toLowerCase().includes(N.toLowerCase()))),[n,N]),Ee=we(()=>{var v;if(H.length===0)return 1;let s=(v=H[0])==null?void 0:v.id,d=r.findIndex(h=>h.id===s);return d!==-1?d+1:1},[H,r]);return e?p&&k.current?w("div",{className:"flex h-full items-center justify-center",children:w(G,{})}):Ce("div",{className:"flex h-full flex-col",children:[w(Le,{onSearchChange:Te,isTailingEnabled:m,onTailingChange:z,stats:Re}),Ce("div",{className:"relative flex-1 overflow-hidden",children:[w(q,{logs:H,height:Math.max(0,Ne-100),width:"100%",startLineNumber:Ee,outerRef:_,onScroll:ke,isLoadingMore:f}),w(ce,{isVisible:!D,onClick:T})]})]}):w("div",{className:"flex h-full items-center justify-center",children:w("p",{children:"Please provide a log file URL."})})}export{ct as LogConsole,U as useLogScroll,F as useLogStats};
//# sourceMappingURL=index.mjs.map